# import data
new_co2_tsib <- as_tsibble(data_processed, index = datetime)
new_co2_tsib <- new_co2_tsib %>% mutate(datetime = yearweek(datetime))
# monthly time series with the line of best fit
new_co2_trend_plot <- new_co2_tsib %>%
ggplot(aes(x = datetime, y = value)) +
geom_line(color = 'black', size = .5) +
#geom_smooth(method = "lm", formula = "y ~ x",se = F, color = 'steelblue', size = .8) +
labs(title = 'Increasing CO2 concentration from 1997 to Present',x = 'Year', y = 'CO2 concentrations (ppmv)') +
scale_x_yearmonth(date_breaks = "5 years")
# average_yearly_increase
new_co2_tsib_yearly_change <- new_co2_tsib %>%
group_by(year) %>%
summarise(`yearly_co2` = mean(value)) %>%
ungroup() %>%
mutate(lag_co2 = lag(yearly_co2),
change = yearly_co2 - lag_co2,
percent_change = ((yearly_co2 - lag_co2)/lag_co2)*100)
# getting average increase (i.e. size of the trend)
new_yearly_mean <- mean(new_co2_tsib_yearly_change$change, na.rm = T) # average 1.26 units of co2 change each year
new_yearly_sd <- sd(new_co2_tsib_yearly_change$change, na.rm = T) # with a sd of .51 units of co2
new_change_hist <- ggplot(new_co2_tsib_yearly_change, aes(x = change)) +
geom_histogram(color = 'gray20', fill = 'gray', binwidth = .25) +
scale_x_continuous(breaks = seq(floor(min(new_co2_tsib_yearly_change$change, na.rm =T)),
ceiling(max(new_co2_tsib_yearly_change$change, na.rm =T)), by = 0.25)) +
labs(
title = "Histogram of Yearly Changes in CO2 ppmv",
x = "Change",
y = "Frequency"
)
new_co2_trend_plot / new_change_hist
View(new_co2_tsib)
# inspecting acf and graph of co2 concentrations over time
new_co2_acf <- acf(new_co2_tsib$value, plot = F)
new_co2_acf_plot <-  autoplot(new_co2_acf) +
labs(title = "ACF plot of monthly CO2 Concentrations 1997-Present", x = 'lag', y = 'Autocorrelation')
new_monthly_co2_ave_plot <- new_co2_tsib %>%
group_by(month) %>%
summarise(co2_monthly_ave = mean(value, na.rm = T)) %>%
mutate(month_str = factor(month.abb[month], levels = month.abb)) %>%
ungroup() %>%
ggplot(aes(x = month_str, y = co2_monthly_ave, group = 1)) +
geom_line(size = .8, color = 'purple4') +
geom_point(size = 1.5) +
ggtitle("Average CO2 Concentrations Across\nEach Month") +
xlab('Month') +
ylab('Co2 Concentrations (ppmv)') +
theme(axis.text.x = element_text(angle = 45))
new_co2_acf_plot | new_monthly_co2_ave_plot
View(new_co2_tsib)
View(new_co2_tsib)
# import data
new_co2_tsib <- as_tsibble(data_processed, index = datetime)
# new_co2_tsib <- new_co2_tsib %>% mutate(datetime = yearweek(datetime))
# monthly time series with the line of best fit
new_co2_trend_plot <- new_co2_tsib %>%
ggplot(aes(x = datetime, y = value)) +
geom_line(color = 'black', size = .5) +
#geom_smooth(method = "lm", formula = "y ~ x",se = F, color = 'steelblue', size = .8) +
labs(title = 'Increasing CO2 concentration from 1997 to Present',x = 'Year', y = 'CO2 concentrations (ppmv)') +
scale_x_yearmonth(date_breaks = "5 years")
# average_yearly_increase
new_co2_tsib_yearly_change <- new_co2_tsib %>%
group_by(year) %>%
summarise(`yearly_co2` = mean(value)) %>%
ungroup() %>%
mutate(lag_co2 = lag(yearly_co2),
change = yearly_co2 - lag_co2,
percent_change = ((yearly_co2 - lag_co2)/lag_co2)*100)
# getting average increase (i.e. size of the trend)
new_yearly_mean <- mean(new_co2_tsib_yearly_change$change, na.rm = T) # average 1.26 units of co2 change each year
new_yearly_sd <- sd(new_co2_tsib_yearly_change$change, na.rm = T) # with a sd of .51 units of co2
new_change_hist <- ggplot(new_co2_tsib_yearly_change, aes(x = change)) +
geom_histogram(color = 'gray20', fill = 'gray', binwidth = .25) +
scale_x_continuous(breaks = seq(floor(min(new_co2_tsib_yearly_change$change, na.rm =T)),
ceiling(max(new_co2_tsib_yearly_change$change, na.rm =T)), by = 0.25)) +
labs(
title = "Histogram of Yearly Changes in CO2 ppmv",
x = "Change",
y = "Frequency"
)
new_co2_trend_plot / new_change_hist
# inspecting acf and graph of co2 concentrations over time
new_co2_acf <- acf(new_co2_tsib$value, plot = F)
new_co2_acf_plot <-  autoplot(new_co2_acf) +
labs(title = "ACF plot of monthly CO2 Concentrations 1997-Present", x = 'lag', y = 'Autocorrelation')
new_monthly_co2_ave_plot <- new_co2_tsib %>%
group_by(month) %>%
summarise(co2_monthly_ave = mean(value, na.rm = T)) %>%
mutate(month_str = factor(month.abb[month], levels = month.abb)) %>%
ungroup() %>%
ggplot(aes(x = month_str, y = co2_monthly_ave, group = 1)) +
geom_line(size = .8, color = 'purple4') +
geom_point(size = 1.5) +
ggtitle("Average CO2 Concentrations Across\nEach Month") +
xlab('Month') +
ylab('Co2 Concentrations (ppmv)') +
theme(axis.text.x = element_text(angle = 45))
new_co2_acf_plot | new_monthly_co2_ave_plot
# inspecting acf and graph of co2 concentrations over time
new_co2_acf <- acf(new_co2_tsib$value, plot = F)
new_co2_acf_plot <-  autoplot(new_co2_acf) +
labs(title = "ACF plot of monthly CO2 Concentrations 1997-Present", x = 'lag', y = 'Autocorrelation')
new_monthly_co2_ave_plot <- new_co2_tsib %>%
mutate(month = month(datetime)) %>%
group_by(month) %>%
summarise(co2_monthly_ave = mean(value, na.rm = T)) %>%
mutate(month_str = factor(month.abb[month], levels = month.abb)) %>%
ungroup() %>%
ggplot(aes(x = month_str, y = co2_monthly_ave, group = 1)) +
geom_line(size = .8, color = 'purple4') +
geom_point(size = 1.5) +
ggtitle("Average CO2 Concentrations Across\nEach Month") +
xlab('Month') +
ylab('Co2 Concentrations (ppmv)') +
theme(axis.text.x = element_text(angle = 45))
new_co2_acf_plot | new_monthly_co2_ave_plot
str(new_co2_tsib)
# inspecting acf and graph of co2 concentrations over time
new_co2_acf <- acf(new_co2_tsib$value, plot = F)
new_co2_acf_plot <-  autoplot(new_co2_acf) +
labs(title = "ACF plot of monthly CO2 Concentrations 1997-Present", x = 'lag', y = 'Autocorrelation')
new_monthly_co2_ave_plot <- new_co2_tsib %>%
mutate(
year = year(datetime),
month = month(datetime)
) %>%
group_by(year, month) %>%
summarise(co2_monthly_ave = mean(value, na.rm = TRUE), .groups = 'drop') %>%
group_by(month) %>%
summarise(co2_monthly_ave = mean(co2_monthly_ave, na.rm = TRUE)) %>%
mutate(month_str = factor(month.abb[month], levels = month.abb)) %>%
ungroup() %>%
ggplot(aes(x = month_str, y = co2_monthly_ave, group = 1)) +
geom_line(size = 0.8, color = 'purple4') +
geom_point(size = 1.5) +
ggtitle("Average CO2 Concentrations Across\nEach Month") +
xlab('Month') +
ylab('CO2 Concentrations (ppmv)') +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
new_co2_acf_plot | new_monthly_co2_ave_plot
# inspecting acf and graph of co2 concentrations over time
new_co2_acf <- acf(new_co2_tsib$value, plot = F)
new_co2_acf_plot <-  autoplot(new_co2_acf) +
labs(title = "ACF plot of monthly CO2 Concentrations 1997-Present", x = 'lag', y = 'Autocorrelation')
# Monthly aggregated dataset
new_co2_monthly_averages <- new_co2_tsib %>%
mutate(month = month(datetime, label = TRUE)) %>%  # Extract month with labels
group_by(month) %>%
summarise(co2_monthly_ave = mean(value, na.rm = TRUE)) %>%
ungroup()
new_monthly_co2_ave_plot <- new_co2_tsib %>%
mutate(
year = year(datetime),
month = month(datetime)
) %>%
group_by(year, month) %>%
summarise(co2_monthly_ave = mean(value, na.rm = TRUE), .groups = 'drop') %>%
group_by(month) %>%
summarise(co2_monthly_ave = mean(co2_monthly_ave, na.rm = TRUE)) %>%
mutate(month_str = factor(month.abb[month], levels = month.abb)) %>%
ungroup() %>%
ggplot(aes(x = month_str, y = co2_monthly_ave, group = 1)) +
geom_line(size = 0.8, color = 'purple4') +
geom_point(size = 1.5) +
ggtitle("Average CO2 Concentrations Across\nEach Month") +
xlab('Month') +
ylab('CO2 Concentrations (ppmv)') +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
new_co2_acf_plot | new_monthly_co2_ave_plot
# inspecting acf and graph of co2 concentrations over time
new_co2_acf <- acf(new_co2_tsib$value, plot = F)
new_co2_acf_plot <-  autoplot(new_co2_acf) +
labs(title = "ACF plot of monthly CO2 Concentrations 1997-Present", x = 'lag', y = 'Autocorrelation')
# Monthly aggregated dataset
new_co2_monthly_averages <- data_clean %>% as_tsibble() %>%
mutate(month = month(datetime, label = TRUE)) %>%  # Extract month with labels
group_by(month) %>%
summarise(co2_monthly_ave = mean(value, na.rm = TRUE)) %>%
ungroup()
new_monthly_co2_ave_plot <- new_co2_tsib %>%
mutate(
year = year(datetime),
month = month(datetime)
) %>%
group_by(year, month) %>%
summarise(co2_monthly_ave = mean(value, na.rm = TRUE), .groups = 'drop') %>%
group_by(month) %>%
summarise(co2_monthly_ave = mean(co2_monthly_ave, na.rm = TRUE)) %>%
mutate(month_str = factor(month.abb[month], levels = month.abb)) %>%
ungroup() %>%
ggplot(aes(x = month_str, y = co2_monthly_ave, group = 1)) +
geom_line(size = 0.8, color = 'purple4') +
geom_point(size = 1.5) +
ggtitle("Average CO2 Concentrations Across\nEach Month") +
xlab('Month') +
ylab('CO2 Concentrations (ppmv)') +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
new_co2_acf_plot | new_monthly_co2_ave_plot
View(new_co2_monthly_averages)
# inspecting acf and graph of co2 concentrations over time
new_co2_acf <- acf(new_co2_tsib$value, plot = F)
new_co2_acf_plot <-  autoplot(new_co2_acf) +
labs(title = "ACF plot of monthly CO2 Concentrations 1997-Present", x = 'lag', y = 'Autocorrelation')
# Monthly aggregated dataset
new_co2_monthly_averages <- data_clean %>% as_tsibble() %>%
mutate(month = month(datetime, label = TRUE)) %>%  # Extract month with labels
select(month, value) %>%
group_by(month) %>%
summarise(co2_monthly_ave = mean(value, na.rm = TRUE)) %>%
ungroup()
new_monthly_co2_ave_plot <- new_co2_tsib %>%
mutate(
year = year(datetime),
month = month(datetime)
) %>%
group_by(year, month) %>%
summarise(co2_monthly_ave = mean(value, na.rm = TRUE), .groups = 'drop') %>%
group_by(month) %>%
summarise(co2_monthly_ave = mean(co2_monthly_ave, na.rm = TRUE)) %>%
mutate(month_str = factor(month.abb[month], levels = month.abb)) %>%
ungroup() %>%
ggplot(aes(x = month_str, y = co2_monthly_ave, group = 1)) +
geom_line(size = 0.8, color = 'purple4') +
geom_point(size = 1.5) +
ggtitle("Average CO2 Concentrations Across\nEach Month") +
xlab('Month') +
ylab('CO2 Concentrations (ppmv)') +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
new_co2_acf_plot | new_monthly_co2_ave_plot
View(new_monthly_co2_ave_plot)
View(new_co2_monthly_averages)
# inspecting acf and graph of co2 concentrations over time
new_co2_acf <- acf(new_co2_tsib$value, plot = F)
new_co2_acf_plot <-  autoplot(new_co2_acf) +
labs(title = "ACF plot of monthly CO2 Concentrations 1997-Present", x = 'lag', y = 'Autocorrelation')
# Monthly aggregated dataset
new_co2_monthly_averages <- data_clean %>%
mutate(MonthYear = yearmonth(datetime)) %>%  # Convert datetime to MonthYear format
as_tsibble(index = MonthYear) %>%  # Set MonthYear as the index
group_by(MonthYear) %>%  # Group by MonthYear to aggregate monthly averages
summarise(co2_monthly_ave = mean(value, na.rm = TRUE)) %>%
ungroup()
# inspecting acf and graph of co2 concentrations over time
new_co2_acf <- acf(new_co2_tsib$value, plot = F)
new_co2_acf_plot <-  autoplot(new_co2_acf) +
labs(title = "ACF plot of monthly CO2 Concentrations 1997-Present", x = 'lag', y = 'Autocorrelation')
# Monthly aggregated dataset
new_co2_monthly_averages <- data_clean %>%
mutate(MonthYear = yearmonth(datetime)) %>%  # Convert datetime to MonthYear format
group_by(MonthYear) %>%  # Group by MonthYear to aggregate monthly averages
summarise(co2_monthly_ave = mean(value, na.rm = TRUE)) %>%  # Calculate monthly average
ungroup() %>%
as_tsibble(index = MonthYear)  # Convert to tsibble with MonthYear as index
new_monthly_co2_ave_plot <- new_co2_tsib %>%
mutate(
year = year(datetime),
month = month(datetime)
) %>%
group_by(year, month) %>%
summarise(co2_monthly_ave = mean(value, na.rm = TRUE), .groups = 'drop') %>%
group_by(month) %>%
summarise(co2_monthly_ave = mean(co2_monthly_ave, na.rm = TRUE)) %>%
mutate(month_str = factor(month.abb[month], levels = month.abb)) %>%
ungroup() %>%
ggplot(aes(x = month_str, y = co2_monthly_ave, group = 1)) +
geom_line(size = 0.8, color = 'purple4') +
geom_point(size = 1.5) +
ggtitle("Average CO2 Concentrations Across\nEach Month") +
xlab('Month') +
ylab('CO2 Concentrations (ppmv)') +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
new_co2_acf_plot | new_monthly_co2_ave_plot
View(new_co2_monthly_averages)
# inspecting acf and graph of co2 concentrations over time
new_co2_acf <- acf(new_co2_tsib$value, plot = F)
new_co2_acf_plot <-  autoplot(new_co2_acf) +
labs(title = "ACF plot of monthly CO2 Concentrations 1997-Present", x = 'lag', y = 'Autocorrelation')
# Monthly aggregated dataset
new_co2_monthly_averages <- data_clean %>%
mutate(MonthYear = yearmonth(datetime)) %>%  # Convert datetime to MonthYear format
group_by(MonthYear) %>%  # Group by MonthYear to aggregate monthly averages
summarise(co2_monthly_ave = mean(value, na.rm = TRUE)) %>%  # Calculate monthly average
ungroup() %>%
as_tsibble(index = MonthYear)  # Convert to tsibble with MonthYear as index
# make a montly average co2 plot
new_monthly_co2_ave_plot <- new_co2_monthly_averages %>%
mutate(month = month(MonthYear)) %>%
ggplot(aes(x = month, y = co2_monthly_ave, group = 1)) +
geom_line(size = .8, color = 'purple4') +
geom_point(size = 1.5) +
ggtitle("Average CO2 Concentrations Across\nEach Month") +
xlab('Month') +
ylab('Co2 Concentrations (ppmv)') +
theme(axis.text.x = element_text(angle = 45))
new_co2_acf_plot | new_monthly_co2_ave_plot
# inspecting acf and graph of co2 concentrations over time
new_co2_acf <- acf(new_co2_tsib$value, plot = F)
new_co2_acf_plot <-  autoplot(new_co2_acf) +
labs(title = "ACF plot of monthly CO2 Concentrations 1997-Present", x = 'lag', y = 'Autocorrelation')
# Monthly aggregated dataset
new_co2_monthly_averages <- data_clean %>%
mutate(MonthYear = yearmonth(datetime)) %>%  # Convert datetime to MonthYear format
group_by(MonthYear) %>%  # Group by MonthYear to aggregate monthly averages
summarise(co2_monthly_ave = mean(value, na.rm = TRUE)) %>%  # Calculate monthly average
ungroup() %>%
as_tsibble(index = MonthYear)  # Convert to tsibble with MonthYear as index
# make a montly average co2 plot
new_monthly_co2_ave_plot <- new_co2_monthly_averages %>%
mutate(month = month(MonthYear)) %>%
group_by(month) %>%
summarise(co2_monthly_ave = mean(value, na.rm = T)) %>%
mutate(month_str = factor(month.abb[month], levels = month.abb)) %>%
ungroup() %>%
ggplot(aes(x = month_str, y = co2_monthly_ave, group = 1)) +
geom_line(size = .8, color = 'purple4') +
geom_point(size = 1.5) +
ggtitle("Average CO2 Concentrations Across\nEach Month") +
xlab('Month') +
ylab('Co2 Concentrations (ppmv)') +
theme(axis.text.x = element_text(angle = 45))
new_co2_acf_plot | new_monthly_co2_ave_plot
# inspecting acf and graph of co2 concentrations over time
new_co2_acf <- acf(new_co2_tsib$value, plot = F)
new_co2_acf_plot <-  autoplot(new_co2_acf) +
labs(title = "ACF plot of monthly CO2 Concentrations 1997-Present", x = 'lag', y = 'Autocorrelation')
# Monthly aggregated dataset
new_co2_monthly_averages <- data_clean %>%
mutate(MonthYear = yearmonth(datetime)) %>%  # Convert datetime to MonthYear format
group_by(MonthYear) %>%  # Group by MonthYear to aggregate monthly averages
summarise(co2_monthly_ave = mean(value, na.rm = TRUE)) %>%  # Calculate monthly average
ungroup() %>%
as_tsibble(index = MonthYear)  # Convert to tsibble with MonthYear as index
# make a montly average co2 plot
new_monthly_co2_ave_plot <- new_co2_monthly_averages %>%
mutate(month = month(MonthYear)) %>%
group_by(month) %>%
summarise(co2_monthly_ave = mean(value, na.rm = T)) %>%
mutate(month_str = factor(month.abb[month], levels = month.abb)) %>%
ungroup() %>%
ggplot(aes(x = month, y = co2_monthly_ave, group = 1)) +
geom_line(size = .8, color = 'purple4') +
geom_point(size = 1.5) +
ggtitle("Average CO2 Concentrations Across\nEach Month") +
xlab('Month') +
ylab('Co2 Concentrations (ppmv)') +
theme(axis.text.x = element_text(angle = 45))
new_co2_acf_plot | new_monthly_co2_ave_plot
# inspecting acf and graph of co2 concentrations over time
new_co2_acf <- acf(new_co2_tsib$value, plot = F)
new_co2_acf_plot <-  autoplot(new_co2_acf) +
labs(title = "ACF plot of monthly CO2 Concentrations 1997-Present", x = 'lag', y = 'Autocorrelation')
# Monthly aggregated dataset
new_co2_monthly_averages <- data_clean %>%
mutate(MonthYear = yearmonth(datetime)) %>%  # Convert datetime to MonthYear format
group_by(MonthYear) %>%  # Group by MonthYear to aggregate monthly averages
summarise(co2_monthly_ave = mean(value, na.rm = TRUE)) %>%  # Calculate monthly average
ungroup() %>%
as_tsibble(index = MonthYear)  # Convert to tsibble with MonthYear as index
# make a montly average co2 plot
new_monthly_co2_ave_plot <- new_co2_monthly_averages %>%
mutate(month = month(MonthYear)) %>%
group_by(month) %>%
summarise(co2_monthly_ave = mean(value, na.rm = T)) %>%
ungroup() %>%
ggplot(aes(x = month, y = co2_monthly_ave, group = 1)) +
geom_line(size = .8, color = 'purple4') +
geom_point(size = 1.5) +
ggtitle("Average CO2 Concentrations Across\nEach Month") +
xlab('Month') +
ylab('Co2 Concentrations (ppmv)') +
theme(axis.text.x = element_text(angle = 45))
new_co2_acf_plot | new_monthly_co2_ave_plot
# inspecting acf and graph of co2 concentrations over time
new_co2_acf <- acf(new_co2_tsib$value, plot = F)
new_co2_acf_plot <-  autoplot(new_co2_acf) +
labs(title = "ACF plot of monthly CO2 Concentrations 1997-Present", x = 'lag', y = 'Autocorrelation')
# Monthly aggregated dataset
new_co2_monthly_averages <- data_clean %>%
mutate(MonthYear = yearmonth(datetime)) %>%  # Convert datetime to MonthYear format
group_by(MonthYear) %>%  # Group by MonthYear to aggregate monthly averages
summarise(co2_monthly_ave = mean(value, na.rm = TRUE)) %>%  # Calculate monthly average
ungroup() %>%
as_tsibble(index = MonthYear)  # Convert to tsibble with MonthYear as index
# make a montly average co2 plot
new_monthly_co2_ave_plot <- new_co2_monthly_averages %>%
mutate(month = month(MonthYear)) %>%
group_by(month) %>%
summarise(co2_monthly_ave = mean(value, na.rm = T)) %>%
mutate(month_str = factor(month.abb[month], levels = month.abb)) %>%
ungroup() %>%
ggplot(aes(x = month_str, y = co2_monthly_ave, group = 1)) +
geom_line(size = .8, color = 'purple4') +
geom_point(size = 1.5) +
ggtitle("Average CO2 Concentrations Across\nEach Month") +
xlab('Month') +
ylab('Co2 Concentrations (ppmv)') +
theme(axis.text.x = element_text(angle = 45))
new_co2_acf_plot | new_monthly_co2_ave_plot
View(co2_tsib)
# inspecting acf and graph of co2 concentrations over time
new_co2_acf <- acf(new_co2_tsib$value, plot = F)
new_co2_acf_plot <-  autoplot(new_co2_acf) +
labs(title = "ACF plot of monthly CO2 Concentrations 1997-Present", x = 'lag', y = 'Autocorrelation')
# Monthly aggregated dataset
new_co2_monthly_averages <- data_clean %>%
mutate(month = month(datetime)) %>%  # Convert datetime to MonthYear format
group_by(month) %>%  # Group by MonthYear to aggregate monthly averages
summarise(co2_monthly_ave = mean(value, na.rm = TRUE)) %>%  # Calculate monthly average
ungroup() %>%
as_tsibble(index = month)  # Convert to tsibble with MonthYear as index
# make a montly average co2 plot
new_monthly_co2_ave_plot <- new_co2_monthly_averages %>%
mutate(month_str = factor(month.abb[month], levels = month.abb)) %>%
ungroup() %>%
ggplot(aes(x = month_str, y = co2_monthly_ave, group = 1)) +
geom_line(size = .8, color = 'purple4') +
geom_point(size = 1.5) +
ggtitle("Average CO2 Concentrations Across\nEach Month") +
xlab('Month') +
ylab('Co2 Concentrations (ppmv)') +
theme(axis.text.x = element_text(angle = 45))
new_co2_acf_plot | new_monthly_co2_ave_plot
# checking for stationarity
# adf.test(co2_tsib$value)
# making a plot to show how the relationship looks like with yearly averages over the seasons
new_yearly_ave_w_residuals <- new_co2_tsib %>% as_tibble() %>%
mutate(year = year(datetime)) %>%
group_by(year) %>%
mutate(`Yearly Co2` = mean(value)) %>%
mutate(residual = value - `Yearly Co2`) %>%
pivot_longer(cols = c(value, `Yearly Co2`, residual), names_to = "type", values_to = "Monthly Co2") %>%
mutate(residual_bool = if_else(type == "residual", "Residuals", "Monthly Time Series Plotted on Yearly Average Co2"))
new_yearly_ave_w_residuals_plot <- new_yearly_ave_w_residuals %>%
ggplot(aes(x = index, y = `Monthly Co2`, color = type)) +
geom_line() +
facet_wrap(~residual_bool, scales = "free_y", ncol = 1) +
xlab('Date') +
theme(legend.position = "none")
yearly_ave_w_residuals_plot
View(new_yearly_ave_w_residuals)
# checking for stationarity
# adf.test(co2_tsib$value)
# making a plot to show how the relationship looks like with yearly averages over the seasons
new_yearly_ave_w_residuals <- new_co2_tsib %>% as_tibble() %>%
mutate(year = year(datetime)) %>%
group_by(year) %>%
mutate(`Yearly_Co2` = mean(value)) %>%
mutate(residual = value - `Yearly_Co2`) %>%
pivot_longer(cols = c(value, `Yearly_Co2`, residual), names_to = "type", values_to = "Yearly Co2") %>%
mutate(residual_bool = if_else(type == "residual", "Residuals", "Monthly Time Series Plotted on Yearly Average Co2"))
new_yearly_ave_w_residuals_plot <- new_yearly_ave_w_residuals %>%
ggplot(aes(x = index, y = `Yearly_Co2`, color = type)) +
geom_line() +
facet_wrap(~residual_bool, scales = "free_y", ncol = 1) +
xlab('Date') +
theme(legend.position = "none")
yearly_ave_w_residuals_plot
# checking for stationarity
adf.test(co2_tsib$value)
# making a plot to show how the relationship looks like with yearly averages over the seasons
new_yearly_ave_w_residuals <- new_co2_tsib %>% as_tibble() %>%
mutate(year = year(datetime)) %>%
group_by(year) %>%
mutate(`Yearly_Co2` = mean(value)) %>%
mutate(residual = value - `Yearly_Co2`) %>%
pivot_longer(cols = c(value, `Yearly_Co2`, residual), names_to = "type", values_to = "Yearly Co2") %>%
mutate(residual_bool = if_else(type == "residual", "Residuals", "Monthly Time Series Plotted on Yearly Average Co2"))
new_yearly_ave_w_residuals_plot <- new_yearly_ave_w_residuals %>%
ggplot(aes(x = index, y = `Yearly_Co2`, color = type)) +
geom_line() +
facet_wrap(~residual_bool, scales = "free_y", ncol = 1) +
xlab('Date') +
theme(legend.position = "none")
yearly_ave_w_residuals_plot
# checking for stationarity
adf.test(new_co2_tsib$value)
# making a plot to show how the relationship looks like with yearly averages over the seasons
new_yearly_ave_w_residuals <- new_co2_tsib %>% as_tibble() %>%
mutate(year = year(datetime)) %>%
group_by(year) %>%
mutate(`Yearly_Co2` = mean(value)) %>%
mutate(residual = value - `Yearly_Co2`) %>%
pivot_longer(cols = c(value, `Yearly_Co2`, residual), names_to = "type", values_to = "Yearly Co2") %>%
mutate(residual_bool = if_else(type == "residual", "Residuals", "Monthly Time Series Plotted on Yearly Average Co2"))
new_yearly_ave_w_residuals_plot <- new_yearly_ave_w_residuals %>%
ggplot(aes(x = index, y = `Yearly_Co2`, color = type)) +
geom_line() +
facet_wrap(~residual_bool, scales = "free_y", ncol = 1) +
xlab('Date') +
theme(legend.position = "none")
yearly_ave_w_residuals_plot
# checking for stationarity
adf.test(co2_present$value)
# checking for stationarity
adf.test(co2_present)
# making a plot to show how the relationship looks like with yearly averages over the seasons
new_yearly_ave_w_residuals <- new_co2_tsib %>% as_tibble() %>%
mutate(year = year(datetime)) %>%
group_by(year) %>%
mutate(`Yearly_Co2` = mean(value)) %>%
mutate(residual = value - `Yearly_Co2`) %>%
pivot_longer(cols = c(value, `Yearly_Co2`, residual), names_to = "type", values_to = "Yearly Co2") %>%
mutate(residual_bool = if_else(type == "residual", "Residuals", "Monthly Time Series Plotted on Yearly Average Co2"))
new_yearly_ave_w_residuals_plot <- new_yearly_ave_w_residuals %>%
ggplot(aes(x = index, y = `Yearly_Co2`, color = type)) +
geom_line() +
facet_wrap(~residual_bool, scales = "free_y", ncol = 1) +
xlab('Date') +
theme(legend.position = "none")
yearly_ave_w_residuals_plot
?adf.test
